<!DOCTYPE html>
<html>
<body>

 

 

<h1>The Window Navigator Object</h1>
<h2>The The geolocation Property</h2>

 

 

<p id="demo"></p>
<div id="test"></div>

 

 

 

<script>
  const directionInfo = [];
  const testElement =  document.getElementById("test");
  let showDistance = document.createElement("p");
  testElement.appendChild(showDistance);
  let showDis = 0;
  showDistance.textContent = "You're away from the station " + showDis + " meters";

 

 

  // JavaScript program to calculate Distance Between
// Two Points on Earth

function distance(lat1,
                     lat2, lon1, lon2)
    {

        // The math module contains a function
        // named toRadians which converts from
        // degrees to radians.
        lon1 =  lon1 * Math.PI / 180;
        lon2 = lon2 * Math.PI / 180;
        lat1 = lat1 * Math.PI / 180;
        lat2 = lat2 * Math.PI / 180;

        // Haversine formula
        let dlon = lon2 - lon1;
        let dlat = lat2 - lat1;
        let a = Math.pow(Math.sin(dlat / 2), 2)
                 + Math.cos(lat1) * Math.cos(lat2)
                 * Math.pow(Math.sin(dlon / 2),2);

        let c = 2 * Math.asin(Math.sqrt(a));

        // Radius of earth in kilometers. Use 3956
        // for miles
        let r = 6371;

        // calculate the result
        return(c * r * 1000);
    }

// Driver code

 

if (navigator.geolocation) {
  setInterval(getCurrent, 6000)
} else { 
  document.getElementById("demo").innerHTML =
  "Geolocation is not supported by this browser.";
}

 

function getCurrent() {
    navigator.geolocation.getCurrentPosition(showPosition);
    console.log(directionInfo);
}

 

function showPosition(position) {

 

  if(directionInfo.length > 0) {
    let lat1 = directionInfo[0].Lat;
    let lon1 = directionInfo[0].Lon;

 

    let lat2 = directionInfo[directionInfo.length-1].Lat;
    let lon2 =  directionInfo[directionInfo.length-1].Lon;
    showDis = distance(lat1, lat2, lon1, lon2);
   }

 

 

  var currentdate = new Date();

 

  const car = {Lat:position.coords.latitude, Lon:position.coords.longitude, Date:currentdate};

 

  directionInfo.push(car);

  let p = document.createElement("p");

 

  testElement.appendChild(p);

 

  directionInfo.forEach(element => {
    if(directionInfo.length < 60) {
      p.textContent =  "Date: " + element.Date + "\n" +
      "Latitude: " + element.Lat + "\n" +
      "Longitude: " + element.Lon;
    }
  });

 

}

 

 

        
</script>

 

 

</body>
</html>
